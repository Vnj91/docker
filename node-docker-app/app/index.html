<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>User Profile</title>
  <style>
    .container { margin: 40px auto; width: 80%; }
    img { width: 300px; display: block; margin-bottom: 20px; }
    button { padding: 10px 20px; background: #667eea; color: white; border: none; cursor: pointer; }
    button:hover { background: #5568d3; }
    #container-edit { display: none; }
    input { padding: 8px; width: 250px; }
  </style>
</head>

<body>
  <div class="container" id="container">
    <h1>User Profile</h1>
    <img src="/profile-picture" />
    <p>Name: <b id="name">Loading...</b></p>
    <p>Email: <b id="email">Loading...</b></p>
    <p>Interests: <b id="interests">Loading...</b></p>
    <button onclick="editProfile()">Edit Profile</button>
  </div>

  <div class="container" id="container-edit">
    <h1>Edit Profile</h1>
    <input id="input-name" placeholder="Name" /><br /><br />
    <input id="input-email" placeholder="Email" /><br /><br />
    <input id="input-interests" placeholder="Interests" /><br /><br />
    <button onclick="saveProfile()">Save</button>
  </div>

<script>
async function loadProfile() {
  const res = await fetch('/get-profile');
  const user = await res.json();

  const name = user.name || 'Anna Smith';
  const email = user.email || 'anna.smith@example.com';
  const interests = user.interests || 'coding';

  document.getElementById('name').textContent = name;
  document.getElementById('email').textContent = email;
  document.getElementById('interests').textContent = interests;

  document.getElementById('input-name').value = name;
  document.getElementById('input-email').value = email;
  document.getElementById('input-interests').value = interests;
}

function editProfile() {
  document.getElementById('container').style.display = 'none';
  document.getElementById('container-edit').style.display = 'block';
}

async function saveProfile() {
  const payload = {
    name: document.getElementById('input-name').value,
    email: document.getElementById('input-email').value,
    interests: document.getElementById('input-interests').value
  };

  const res = await fetch('/update-profile', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(payload)
  });

  const user = await res.json();

  document.getElementById('container-edit').style.display = 'none';
  document.getElementById('container').style.display = 'block';

  document.getElementById('name').textContent = user.name;
  document.getElementById('email').textContent = user.email;
  document.getElementById('interests').textContent = user.interests;
}

loadProfile();
</script>
</body>
</html>
